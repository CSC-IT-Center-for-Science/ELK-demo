---
#  - name: update all packages first
#    yum: pkg=* state=latest

  - name: add logstash repo
    template: src=templates/logstash.repo.j2 dest=/etc/yum.repos.d/logstash.repo owner=root group=root mode=0644
    register: logstashrepo
    when: ansible_os_family == "RedHat" and add_logstash_repofile == "yes"

  - name: install software from logstash repo
    yum: "pkg={{item}} state=installed"
    with_items: programs_to_install
    when: ansible_distribution_major_version == "6"

  - name: install software from logstash repo EL7
    yum: "pkg={{item}} state=installed"
    with_items: el7programs_to_install
    when: ansible_distribution_major_version == "7"

  - name: enable services on boot
    service: name={{item}} enabled=yes
    with_items: programs_on_boot

# Here we could add some templates for logstash config
# Also logstash -t (config test) can be used to verify the config.
